{% extends "base.html" %}

{% block title %}Create Account{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/premium-auth.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
{% endblock %}

{% block content %}
<div class="auth-container">
  <!-- Left Side - Branding -->
  <div class="auth-branding">
    <div class="branding-content">
      <div class="brand-logo">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
          <defs>
            <linearGradient id="gradient1" x1="2" y1="2" x2="22" y2="12">
              <stop offset="0%" stop-color="#667eea" />
              <stop offset="100%" stop-color="#764ba2" />
            </linearGradient>
            <linearGradient id="gradient2" x1="2" y1="7" x2="22" y2="22">
              <stop offset="0%" stop-color="#f093fb" />
              <stop offset="100%" stop-color="#f5576c" />
            </linearGradient>
          </defs>
        </svg>
      </div>
      <h1 class="brand-title">Join Our<br><span class="highlight">Community</span></h1>
      <p class="brand-description">Start your journey to better mood management and personalized activity
        recommendations.</p>

      <div class="stats-grid">
        <div class="stat-item">
          <h3>10K+</h3>
          <p class="brand-description">Active Users</p>
        </div>
        <div class="stat-item">
          <h3>50K+</h3>
          <p class="brand-description">Activities</p>
        </div>
        <div class="stat-item">
          <h3>98%</h3>
          <p class="brand-description">Satisfaction</p>
        </div>
      </div>
    </div>

    <div class="decorative-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
    </div>
  </div>

  <!-- Right Side - Registration Form -->
  <div class="auth-form-section">
    <div class="form-container wide-form">
      <div class="form-header">
        <h2>Create Account</h2>
        <p>Join MoodMatch in just a few steps</p>
      </div>

      <!-- Progress Steps -->
      <div class="progress-steps">
        <div class="step active" data-step="1">
          <div class="step-number">1</div>
          <span style="font-size: medium;">Personal</span>
        </div>
        <div class="step" data-step="2">
          <div class="step-number">2</div>
          <span style="font-size: medium;">Contact</span>
        </div>
        <div class="step" data-step="3">
          <div class="step-number">3</div>
          <span style="font-size: medium;">Profile</span>
        </div>
        <div class="step" data-step="4">
          <div class="step-number">4</div>
          <span style="font-size: medium;">Security</span>
        </div>
        <div class="step" data-step="5">
          <div class="step-number">5</div>
          <span style="font-size: medium;">Review</span>
        </div>
      </div>

      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      {% for category, message in messages %}
      <div class="alert alert-{{ category }}">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="8" x2="12" y2="12" />
          <line x1="12" y1="16" x2="12.01" y2="16" />
        </svg>
        {{ message }}
      </div>
      {% endfor %}
      {% endif %}
      {% endwith %}

      <form action="{{ url_for('auth.register') }}" method="POST" enctype="multipart/form-data"
        class="auth-form multi-step-form" id="registrationForm">

        <!-- Step 1: Personal Information -->
        <div class="form-step active" data-step="1">
          <div class="step-content">
            <div class="form-row">
              <div class="form-group">
                <label for="first_name">First Name <span class="required">*</span></label>
                <div class="input-container">
                  <input type="text" id="first_name" name="first_name" placeholder="John" required
                    autocomplete="given-name">
                </div>
              </div>
              <div class="form-group">
                <label for="last_name">Last Name <span class="required">*</span></label>
                <div class="input-container">
                  <input type="text" id="last_name" name="last_name" placeholder="Doe" required
                    autocomplete="family-name">
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>Gender <span class="required">*</span></label>
              <div class="radio-group">
                <label class="radio-label">
                  <input type="radio" name="gender" value="male" required>
                  <!-- <span class="radio-custom"></span> -->
                  <span>üë® Male</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="gender" value="female">
                  <!-- <span class="radio-custom"></span> -->
                  <span>üë© Female</span>
                </label>
                <label class="radio-label">
                  <input type="radio" name="gender" value="other">
                  <!-- <span class="radio-custom"></span> -->
                  <span>‚ößÔ∏è Other</span>
                </label>
              </div>
            </div>

            <div class="form-group">
              <label for="date_of_birth">Date of Birth <span class="required">*</span></label>
              <div class="input-container">
                <input type="date" id="date_of_birth" name="date_of_birth" required autocomplete="bday">
              </div>
              <small class="help-text">You must be at least 13 years old</small>
            </div>
          </div>
        </div>

        <!-- Step 2: Contact Details -->
        <div class="form-step" data-step="2">
          <div class="step-content">
            <div class="form-group">
              <label for="email">Email Address <span class="required">*</span></label>
              <div class="input-container">
                <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                  stroke-width="2">
                  <rect x="2" y="4" width="20" height="16" rx="2" />
                  <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" />
                </svg>
                <input type="email" id="email" name="email" placeholder="john.doe@example.com" required
                  autocomplete="email">
              </div>
            </div>

            <div class="form-group">
              <label for="phone">Phone Number <span class="required">*</span></label>
              <div class="input-container">
                <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                  stroke-width="2">
                  <path
                    d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
                </svg>
                <input type="tel" id="phone" name="phone" placeholder="+1 (555) 123-4567" required autocomplete="tel">
              </div>
            </div>

            <div class="form-group">
              <label for="street">Street Address <span class="required">*</span></label>
              <div class="input-container">
                <input type="text" id="street" name="street" placeholder="123 Main St, Apt 4B" required
                  autocomplete="street-address">
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="city">City <span class="required">*</span></label>
                <input type="text" id="city" name="city" placeholder="New York" required autocomplete="address-level2">
              </div>
              <div class="form-group">
                <label for="state">State/Province <span class="required">*</span></label>
                <input type="text" id="state" name="state" placeholder="NY" required autocomplete="address-level1">
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="postal_code">Postal Code <span class="required">*</span></label>
                <input type="text" id="postal_code" name="postal_code" placeholder="10001" required
                  autocomplete="postal-code">
              </div>
              <div class="form-group">
                <label for="country">Country <span class="required">*</span></label>
                <select id="country" name="country" required autocomplete="country">
                  <option value="">Select Country</option>
                  <option value="US">United States</option>
                  <option value="CA">Canada</option>
                  <option value="UK">United Kingdom</option>
                  <option value="AU">Australia</option>
                  <option value="IN">India</option>
                  <option value="other">Other</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 3: Profile & Interests -->
        <div class="form-step" data-step="3">
          <div class="step-content">
            <div class="form-group">
              <label>Profile Picture</label>
              <div class="file-upload-area" id="fileUploadArea">
                <input type="file" id="profile_picture" name="profile_picture" accept="image/*">
                <div class="upload-content">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                    <polyline points="17 8 12 3 7 8" />
                    <line x1="12" y1="3" x2="12" y2="15" />
                  </svg>
                  <p><strong>Click to upload</strong> or drag and drop</p>
                  <small>PNG, JPG up to 5MB</small>
                </div>
                <div class="file-preview hidden" id="filePreview">
                  <img id="previewImage" src="" alt="Preview">
                  <div class="file-info">
                    <span id="fileName"></span>
                    <button type="button" class="btn-text" onclick="removeFile()">Remove</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>Choose Your Interests <span class="required">*</span></label>
              <small class="help-text">Select at least 3 interests</small>
              <div class="interests-grid">
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="writing">
                  <span>‚úçÔ∏è Writing</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="drawing">
                  <span>üé® Drawing</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="music">
                  <span>üéµ Music</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="photography">
                  <span>üì∑ Photography</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="reading">
                  <span>üìö Reading</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="gaming">
                  <span>üéÆ Gaming</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="sports">
                  <span>‚öΩ Sports</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="travel">
                  <span>‚úàÔ∏è Travel</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="cooking">
                  <span>üç≥ Cooking</span>
                </label>
                <label class="interest-tag">
                  <input type="checkbox" name="interests" value="fitness">
                  <span>üí™ Fitness</span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 4: Security -->
        <div class="form-step" data-step="4">
          <div class="step-content">
            <div class="form-group">
              <label for="password">Create Password <span class="required">*</span></label>
              <div class="input-container">
                <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                  stroke-width="2">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                  <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                </svg>
                <input type="password" id="password" name="password" placeholder="Create a strong password" required
                  autocomplete="new-password" minlength="8">
                <button type="button" class="password-toggle" onclick="togglePasswordField('password')">
                  <svg class="eye-open" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                    <circle cx="12" cy="12" r="3" />
                  </svg>
                  <svg class="eye-closed hidden" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path
                      d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" />
                    <line x1="1" y1="1" x2="23" y2="23" />
                  </svg>
                </button>
              </div>

              <div class="password-strength">
                <div class="strength-bar">
                  <div class="strength-fill" id="strengthFill"></div>
                </div>
                <small id="strengthText">Password strength</small>
              </div>

              <div class="password-requirements">
                <div class="requirement" id="req-length">
                  <svg class="check-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <polyline points="20 6 9 17 4 12" />
                  </svg>
                  <span>At least 8 characters</span>
                </div>
                <div class="requirement" id="req-uppercase">
                  <svg class="check-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <polyline points="20 6 9 17 4 12" />
                  </svg>
                  <span>One uppercase letter</span>
                </div>
                <div class="requirement" id="req-number">
                  <svg class="check-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <polyline points="20 6 9 17 4 12" />
                  </svg>
                  <span>One number</span>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="confirm_password">Confirm Password <span class="required">*</span></label>
              <div class="input-container">
                <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                  stroke-width="2">
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                  <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                </svg>
                <input type="password" id="confirm_password" name="confirm_password"
                  placeholder="Re-enter your password" required autocomplete="new-password">
              </div>
            </div>
          </div>
        </div>

        <!-- Step 5: Review -->
        <div class="form-step" data-step="5">
          <div class="step-content">
            <div class="review-section">
              <h3>Review Your Information</h3>
              <div class="review-grid" id="reviewContent">
                <!-- Will be populated by JavaScript -->
              </div>
            </div>

            <label class="checkbox-label">
              <input type="checkbox" name="terms" id="terms" required>
              <!-- <span class="checkbox-custom"></span> -->
              <span class="checkbox-text">I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy
                  Policy</a></span>
            </label>
          </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="form-navigation">
          <button type="button" class="btn-secondary" id="prevBtn" onclick="changeStep(-1)" style="display: none;">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="19" y1="12" x2="5" y2="12" />
              <polyline points="12 19 5 12 12 5" />
            </svg>
            <span>Back</span>
          </button>
          <button type="button" class="btn btn-primary btn-sm navbar-cta" id="nextBtn" onclick="changeStep(1)">
            <span>Continue</span>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="5" y1="12" x2="19" y2="12" />
              <polyline points="12 5 19 12 12 19" />
            </svg>
          </button>
        </div>
      </form>

      <div class="signup-link">
        <span>Already have an account?</span>
        <a href="{{ url_for('auth.login') }}">Sign in</a>
      </div>
    </div>
  </div>
</div>

<!-- Confirmation Modal -->
<div class="modal" id="confirmModal">
  <div class="modal-content">
    <div class="modal-icon">
      <svg width="60" height="60" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="#667eea" stroke-width="2" />
        <line x1="12" y1="8" x2="12" y2="12" stroke="#667eea" stroke-width="2" />
        <line x1="12" y1="16" x2="12.01" y2="16" stroke="#667eea" stroke-width="2" />
      </svg>
    </div>
    <h3>Confirm Registration</h3>
    <p>Are you sure all the information is correct?</p>
    <div class="modal-actions">
      <button type="button" class="btn-secondary" onclick="closeModal('confirmModal')">Review Again</button>
      <button type="button" class="btn-primary" onclick="submitForm()">Confirm & Create Account</button>
    </div>
  </div>
</div>

<!-- Success Modal -->
<div class="modal" id="successModal">
  <div class="modal-content success-modal">
    <div class="modal-icon">
      <svg width="60" height="60" viewBox="0 0 24 24" fill="none">
        <circle cx="12" cy="12" r="10" stroke="#10b981" stroke-width="2" />
        <path d="M8 12l2 2 4-4" stroke="#10b981" stroke-width="2" stroke-linecap="round" />
      </svg>
    </div>
    <h3>Account Created Successfully!</h3>
    <p>Welcome to MoodMatch! Redirecting to login page...</p>
  </div>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/registration.js') }}"></script>
{% endblock %}